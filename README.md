# PEV-SC
PEV-SC: An Ensemble Learning-Based Model for Porcine Enterovirus Identification

## Dataset
### Data source
NCBI: https://www.ncbi.nlm.nih.gov
<br>UniProt: https://www.uniprot.org
<br>VirusDIP: https://db.cngb.org/virusdip
### Positive sample
<br><img width="780" height="259" alt="image" src="https://github.com/user-attachments/assets/a4ab2ad0-9f7a-4bcc-8c7a-7ab6a4729689" />
<br>
### Negative sample
<br><img width="780" height="136" alt="image" src="https://github.com/user-attachments/assets/300a047b-87ad-4f2b-b549-7adc0b0e1164" />
<br>
### Dataset structure diagram
<img width="2000" height="1529" alt="Figure3" src="https://github.com/user-attachments/assets/0698b402-25ec-4dd7-b57e-42c154ba206e" />
<br>train_3000_2.csv and val_176_2.csv are used for model training and testing, respectively.
<br>To convert categorical sequence data into numerical values more suitable for machine learning algorithms while eliminating implicit ordinal relationships between categories, the dataset in this study was labeled using categorical encoding: porcine enteric viruses were assigned a value of 0, and all other sequences were assigned a value of 1. 

## Code Information:PEV-SC Architecture diagram
<br>The model utilizes the ESM-2 protein sequence method to extract features from the dataset, followed by a CNN to capture local functional motif characteristics of protein sequences. The amino acid-level features generated by ESM-2 are aggregated into higher-order patterns, while a BiLSTM network is employed to capture long-range contextual dependencies among these motifs, enabling the model to comprehend the global sequence structure. Subsequently, SE and CBAM attention mechanisms are incorporated after the BiLSTM layer to enhance the model's dynamic discriminative capability for sequence classification. Finally, a Stacking ensemble strategy based on logistic regression is applied to integrate predictions from the two aforementioned models, resulting in the construction of a porcine enterovirus identification framework that hierarchically processes local-to-global features while jointly optimizing feature representation and decision fusion.
<img width="1500" height="2000" alt="Figure2" src="https://github.com/user-attachments/assets/dc492ec3-faaa-4015-bccf-91afb8deb395" />


## Requirements
| Library          | Version  |
|------------------|----------|
| numpy            | ≥1.20.0  |
| pandas           | ≥1.3.0   |
| scikit-learn     | ≥1.0.0   |
| tensorflow       | ≥2.6.0   |
| torch            | ≥1.10.0  |
| esm              | ≥0.5.0   |
| imbalanced-learn | ≥0.9.0   |

## Usage Instructions
Run the main script:
   ```bash
   python PEV-SC.py
